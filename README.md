# Trabajo-final-Analitica-Empresarial
import pandas as pd
df_2016 = pd.read_csv("precios_2016.csv")
df_2017 = pd.read_csv("precios_2017.csv")
df_2018 = pd.read_csv("precios_2018.csv")
df_2019 = pd.read_csv("precios_2019.csv")
df_2020 = pd.read_csv("precios_2020.csv")
df_2021 = pd.read_csv("precios_2021.csv")
df_2022 = pd.read_csv("precios_2022.csv")
df_2023s1 = pd.read_csv("precios_2023_3.csv")
df_2023s2 = pd.read_csv("precios_2023_6.csv")
df_2016.columns = ['establecimiento', 'id_producto', 'precio', 'fecha', 'oferta']
df_2017.columns = ['establecimiento', 'id_producto', 'precio', 'fecha', 'oferta']
df_2018.columns = ['id_preciodiario',"declaracion", 'fecha', "fechaanterior", 'oferta', "precio", "precioanterior", 'publico', 'establecimiento', 'ferias', 'id_producto']
df_2019.columns = ['id_preciodiario',"declaracion", 'fecha', "fechaanterior", 'oferta', "precio", "precioanterior", 'publico', 'establecimiento', 'ferias', 'id_producto']
df_2020.columns = ['id_preciodiario',"declaracion", 'fecha', "fechaanterior", 'oferta', "precio", "precioanterior", 'publico', 'establecimiento', 'ferias', 'id_producto']
df_2021.columns = ['id_preciodiario',"declaracion", 'fecha', "fechaanterior", 'oferta', "precio", "precioanterior", 'publico', 'establecimiento', 'ferias', 'id_producto']
df_2022.columns = ['id_preciodiario',"declaracion", 'fecha', "fechaanterior", 'oferta', "precio", "precioanterior", 'publico', 'establecimiento', 'ferias', 'id_producto']
df_2023s1.columns = ['id_preciodiario',"declaracion", 'fecha', "fechaanterior", 'oferta', "precio", "precioanterior", 'publico', 'establecimiento', 'ferias', 'id_producto']
df_2023s2.columns = ['id_preciodiario',"declaracion", 'fecha', "fechaanterior", 'oferta', "precio", "precioanterior", 'publico', 'establecimiento', 'ferias', 'id_producto']
df_2016['fecha']= pd.to_datetime(df_2016['fecha'])
df_2016['anio']= df_2016['fecha'].dt.year
df_2016['mes']= df_2016['fecha'].dt.month
df_2017['fecha']= pd.to_datetime(df_2017['fecha'])
df_2017['anio']= df_2017['fecha'].dt.year
df_2017['mes']= df_2017['fecha'].dt.month
df_2018['fecha']= pd.to_datetime(df_2018['fecha'])
df_2018['anio']= df_2018['fecha'].dt.year
df_2018['mes']= df_2018['fecha'].dt.month
df_2019['fecha']= pd.to_datetime(df_2019['fecha'])
df_2019['anio']= df_2019['fecha'].dt.year
df_2019['mes']= df_2019['fecha'].dt.month
df_2020['fecha']= pd.to_datetime(df_2020['fecha'])
df_2020['anio']= df_2020['fecha'].dt.year
df_2020['mes']= df_2020['fecha'].dt.month
df_2021['fecha']= pd.to_datetime(df_2021['fecha'])
df_2021['anio']= df_2021['fecha'].dt.year
df_2021['mes']= df_2021['fecha'].dt.month
df_2022['fecha']= pd.to_datetime(df_2022['fecha'])
df_2022['anio']= df_2022['fecha'].dt.year
df_2022['mes']= df_2022['fecha'].dt.month
df_2023s1['fecha']= pd.to_datetime(df_2023s1['fecha'])
df_2023s1['anio']= df_2023s1['fecha'].dt.year
df_2023s1['mes']= df_2023s1['fecha'].dt.month
df_2023s2['fecha']= pd.to_datetime(df_2023s2['fecha'])
df_2023s2['anio']= df_2023s2['fecha'].dt.year
df_2023s2['mes']= df_2023s2['fecha'].dt.month
df_2016 = df_2016 [['establecimiento', 'id_producto', 'precio', 'anio', 'mes']].groupby(['establecimiento', 'id_producto', 'anio', 'mes']).mean().reset_index()
df_2017 = df_2017 [['establecimiento', 'id_producto', 'precio', 'anio', 'mes']].groupby(['establecimiento', 'id_producto', 'anio', 'mes']).mean().reset_index()
df_2018 = df_2018 [['establecimiento', 'id_producto', 'precio', 'anio', 'mes']].groupby(['establecimiento', 'id_producto', 'anio', 'mes']).mean().reset_index()
df_2019 = df_2019 [['establecimiento', 'id_producto', 'precio', 'anio', 'mes']].groupby(['establecimiento', 'id_producto', 'anio', 'mes']).mean().reset_index()
df_2020 = df_2020 [['establecimiento', 'id_producto', 'precio', 'anio', 'mes']].groupby(['establecimiento', 'id_producto', 'anio', 'mes']).mean().reset_index()
df_2021 = df_2021 [['establecimiento', 'id_producto', 'precio', 'anio', 'mes']].groupby(['establecimiento', 'id_producto', 'anio', 'mes']).mean().reset_index()
df_2022 = df_2022 [['establecimiento', 'id_producto', 'precio', 'anio', 'mes']].groupby(['establecimiento', 'id_producto', 'anio', 'mes']).mean().reset_index()
df_2023s1 = df_2023s1 [['establecimiento', 'id_producto', 'precio', 'anio', 'mes']].groupby(['establecimiento', 'id_producto', 'anio', 'mes']).mean().reset_index()
df_2023s2 = df_2023s1 [['establecimiento', 'id_producto', 'precio', 'anio', 'mes']].groupby(['establecimiento', 'id_producto', 'anio', 'mes']).mean().reset_index()
df_ptotal = pd.concat([df_2016, df_2017, df_2018, df_2019, df_2020, df_2021, df_2022, df_2023s1, df_2023s2], axis=0)
